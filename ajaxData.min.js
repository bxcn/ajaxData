!function(t,e){"function"==typeof define&&(define.amd||define.cmd)?define(function(n,o,r){return e(t)}):"object"==typeof exports?module.exports=e():t.ajaxData=e(t)}("undefined"!=typeof window?window:this,function(t){"use strict";function e(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t){function i(){function e(t){return function(){n.show(),t&&t()}}var n;return this.ajax=function(e){if(e.url){n="object"==u(e.loading)?e.loading:"string"==typeof e.loading?$(e.loading):document.getElementById("loading")?$("#loading"):$("<div/>");var o=e.cache||!1,r=e.type||"POST",i=e.dataType||"json",a=e.async||!0,c=e.data||null,s=(e.url,{404:function(){console.log("404: http://"+t.location.host+e.url)}}),f={type:r,dataType:i,async:a,data:c,cache:o,statusCode:s,beforeSend:function(){},complete:function(){},success:function(){},error:function(){}};return e=$.extend(f,e),$.ajax(e).always(function(){n.hide()})}},this.post=function(t){return t.type=t.type||"POST",t.beforeSend=e(t.beforeSend),this.ajax(t)},this.get=function(t){return t.type=t.type||"GET",t.beforeSend=e(t.beforeSend),this.ajax(t)},this}var a=function(){function t(){o(this,t),this.fetchData=null}return r(t,[{key:"postAjax",value:function(t){var e=t.data||"";return fetch(t.url,{method:"post",headers:{"Content-Type":"application/json"},body:e})}},{key:"getAjax",value:function(t){console.log("getAjax");var e=t.data||"",n=t.url;return n=n.indexOf("?")>-1?n+"&"+e:n+"?"+e,fetch(n,{method:"get",headers:{"Content-Type":"application/json"}}).catch(function(e){console.log("fetch地址请求无效:"+t.url)})}},{key:"post",value:function(t){return this.fetchData=this.postAjax(t),this}},{key:"get",value:function(t){return this.fetchData=this.getAjax(t),this}},{key:"done",value:function(t){return this.then(t)}},{key:"always",value:function(t){return this.then(t)}},{key:"then",value:function(t){return this.fetchData.then(t),this}},{key:"fail",value:function(t){return this.fetchData.catch(t),this}},{key:"catch",value:function(t){return this.fail(t),this}}]),t}(),c=function(t){function u(t){o(this,u);var n=e(this,(u.__proto__||Object.getPrototypeOf(u)).call(this));return n.defaults={beforeSend:function(){},complete:function(){},success:function(){},error:function(){}},n.defaults=Object.assign(n.defaults,t),n}return n(u,t),r(u,[{key:"status",value:function(t){return t.status>=200&&t.status<300?Promise.resolve(t):Promise.reject(new Error(t.statusText))}},{key:"beforeSend",value:function(){this.defaults.beforeSend(),console.log("beforeSend")}},{key:"complete",value:function(){this.defaults.complete(),console.log("complete")}},{key:"success",value:function(){this.defaults.success(),console.log("success")}},{key:"error",value:function(){this.defaults.error(),console.log("error")}},{key:"json",value:function(t){return t.json()}},{key:"wrapper",value:function(t){var e=this,n=t.then(e.status).then(e.json).catch(function(t){e.error()});return this.success(),n}},{key:"post",value:function(t){return this.beforeSend(),this.fetchData=this.wrapper(this.postAjax(t)),this.complete(),this}},{key:"get",value:function(t){return this.beforeSend(),this.fetchData=this.wrapper(this.getAjax(t)),this.complete(),this}}]),u}(a);return"function"==typeof fetch?{get:function(t){return new c(t).get(t)},post:function(t){return new c(t).post(t)}}:new i}(t);return t.ajaxData=i,i});